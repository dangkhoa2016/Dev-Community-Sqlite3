<div class="card mb-5" id="member-personal-details">
  <div class="d-md-flex">
    <div class="flex-shrink-0 text-center mt-3 mt-sm-0">
      <%= image_tag avatar_url("#{user.email}-#{user.id}"), class: "" %>
    </div>
    <div class="flex-grow-1 p-3">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="fw-bold"><%= user.name %></h3>

        <% if user == current_user %>
          <%= link_to edit_member_personal_details_path, class: "edit-profile", data: { controller: "bs-modal-form" } do %>
            <button type="button" class="btn btn-primary">Edit Details</button>
          <% end %>
        <% end %>
      </div>

      <p class="lead"><%= user.profile_title %></p>
      <p class="lead"><%= user.address %></p>

      <div id="user-connection-status">
        <% if current_user.check_if_already_connected?(user) %>
          <%= link_to "Connect", connections_path, class: "btn btn-primary", data: { controller: "connections", turbo_method: :post, connections_target: "connection", requester_id: current_user.id, connected_id: user.id } %>
        <% elsif get_connection_status(user) == "pending" %>
          <%= render "connections/create", connector: user %>
        <% elsif get_connection_status(user) == "accepted" %>
          <button type="button" class="btn btn-success">Connected</button>
        <% elsif get_connection_status(user) == "rejected"%>
          <button type="buvtton" class="btn btn-danger">Rejected</button>
        <% end %>
      </div>

      <% if @connections.present? %>
        <div id="connection-count">
          <%= link_to pluralize(@connections.count, 'connection'), member_connections_path(user) %>
        </div>
      <% end %>

      <% if current_user != @user && @mutual_connections.present? && @mutual_connections.count > 0 %>
        <div id="mutual-count">
          <%= link_to pluralize(@mutual_connections.count, 'mutual connection'), member_connections_path(user, mutual_connections: true) %>
        </div>
      <% end %>
    </div>
  </div>
</div>
